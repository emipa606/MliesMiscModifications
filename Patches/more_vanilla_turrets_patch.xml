<?xml version="1.0" encoding="utf-8"?>
<Patch>
  <Operation Class="PatchOperationSequence">
    <success>Always</success>
    <operations>
      <li Class="PatchOperationTest">
        <xpath>/Defs/ThingDef[defName="MilitaryTurretGunManned" or defName="MilitaryTurretGun"]/uiIconPath</xpath>
        <success>Invert</success>
      </li>
      <li Class="PatchOperationAdd">
        <success>Always</success>
        <xpath>/Defs/ThingDef[defName="MilitaryTurretGunManned" or defName="MilitaryTurretGun"]</xpath>
        <value>
          <uiIconPath>Security/MilitaryTurret_UI</uiIconPath>
        </value>
      </li>
      <li Class="PatchOperationAdd">
        <success>Always</success>
        <xpath>/Defs/ThingDef[defName="MilitaryTurretGunManned"]/building/placeWorkers</xpath>
        <value>
          <li>PlaceWorker_TurretTop</li>
          <li>PlaceWorker_PreventInteractionSpotOverlap</li>
          <li>PlaceWorker_ShowTurretRadius</li>
        </value>
      </li>
      <li Class="PatchOperationAdd">
        <success>Always</success>
        <xpath>/Defs/ThingDef[defName="MilitaryTurretGun"]/building/placeWorkers</xpath>
        <value>
          <li>PlaceWorker_TurretTop</li>
          <li>PlaceWorker_ShowTurretRadius</li>
        </value>
      </li>
    </operations>
  </Operation>
  <Operation Class="PatchOperationSequence">
    <success>Always</success>
    <operations>
      <li Class="PatchOperationTest">
        <xpath>/Defs/ThingDef[defName="ShredderTurretGunManned" or defName="ShredderTurretGun"]/uiIconPath</xpath>
        <success>Invert</success>
      </li>
      <li Class="PatchOperationAdd">
        <success>Always</success>
        <xpath>/Defs/ThingDef[defName="ShredderTurretGunManned" or defName="ShredderTurretGun"]</xpath>
        <value>
          <uiIconPath>Security/ShredderTurret_UI</uiIconPath>
        </value>
      </li>
      <li Class="PatchOperationAdd">
        <success>Always</success>
        <xpath>/Defs/ThingDef[defName="ShredderTurretGunManned"]/building/placeWorkers</xpath>
        <value>
          <li>PlaceWorker_TurretTop</li>
          <li>PlaceWorker_PreventInteractionSpotOverlap</li>
          <li>PlaceWorker_ShowTurretRadius</li>
        </value>
      </li>
      <li Class="PatchOperationAdd">
        <success>Always</success>
        <xpath>/Defs/ThingDef[defName="ShredderTurretGun"]/building/placeWorkers</xpath>
        <value>
          <li>PlaceWorker_TurretTop</li>
          <li>PlaceWorker_ShowTurretRadius</li>
        </value>
      </li>
    </operations>
  </Operation>
  <Operation Class="PatchOperationSequence">
    <success>Always</success>
    <operations>
      <li Class="PatchOperationTest">
        <xpath>/Defs/ThingDef[defName="PrecisionTurretGunManned" or defName="PrecisionTurretGun"]/uiIconPath</xpath>
        <success>Invert</success>
      </li>
      <li Class="PatchOperationAdd">
        <success>Always</success>
        <xpath>/Defs/ThingDef[defName="PrecisionTurretGunManned" or defName="PrecisionTurretGun"]</xpath>
        <value>
          <uiIconPath>Security/PrecisionTurret_UI</uiIconPath>
        </value>
      </li>
      <li Class="PatchOperationAdd">
        <success>Always</success>
        <xpath>/Defs/ThingDef[defName="PrecisionTurretGunManned"]/building/placeWorkers</xpath>
        <value>
          <li>PlaceWorker_TurretTop</li>
          <li>PlaceWorker_PreventInteractionSpotOverlap</li>
          <li>PlaceWorker_ShowTurretRadius</li>
        </value>
      </li>
      <li Class="PatchOperationAdd">
        <success>Always</success>
        <xpath>/Defs/ThingDef[defName="PrecisionTurretGun"]/building/placeWorkers</xpath>
        <value>
          <li>PlaceWorker_TurretTop</li>
          <li>PlaceWorker_ShowTurretRadius</li>
        </value>
      </li>
    </operations>
  </Operation>
  <Operation Class="PatchOperationSequence">
    <success>Always</success>
    <operations>
      <li Class="PatchOperationTest">
        <xpath>/Defs/ThingDef[defName="BlastTurretGunManned" or defName="BlastTurretGun"]/uiIconPath</xpath>
        <success>Invert</success>
      </li>
      <li Class="PatchOperationAdd">
        <success>Always</success>
        <xpath>/Defs/ThingDef[defName="BlastTurretGunManned" or defName="BlastTurretGun"]</xpath>
        <value>
          <uiIconPath>Security/BlastTurret_UI</uiIconPath>
        </value>
      </li>
      <li Class="PatchOperationAdd">
        <success>Always</success>
        <xpath>/Defs/ThingDef[defName="BlastTurretGunManned"]/building/placeWorkers</xpath>
        <value>
          <li>PlaceWorker_TurretTop</li>
          <li>PlaceWorker_PreventInteractionSpotOverlap</li>
          <li>PlaceWorker_ShowTurretRadius</li>
        </value>
      </li>
      <li Class="PatchOperationAdd">
        <success>Always</success>
        <xpath>/Defs/ThingDef[defName="BlastTurretGun"]/building/placeWorkers</xpath>
        <value>
          <li>PlaceWorker_TurretTop</li>
          <li>PlaceWorker_ShowTurretRadius</li>
        </value>
      </li>
    </operations>
  </Operation>
  <Operation Class="PatchOperationSequence">
    <success>Always</success>
    <operations>
      <li Class="PatchOperationTest">
        <xpath>/Defs/ThingDef[defName="VulcanCannonManned" or defName="VulcanCannon"]/uiIconPath</xpath>
        <success>Invert</success>
      </li>
      <li Class="PatchOperationAdd">
        <success>Always</success>
        <xpath>/Defs/ThingDef[defName="VulcanCannonManned" or defName="VulcanCannon"]</xpath>
        <value>
          <uiIconPath>Security/VulcanCannon_UI</uiIconPath>
        </value>
      </li>
      <li Class="PatchOperationAdd">
        <success>Always</success>
        <xpath>/Defs/ThingDef[defName="VulcanCannonManned"]/building/placeWorkers</xpath>
        <value>
          <li>PlaceWorker_TurretTop</li>
          <li>PlaceWorker_PreventInteractionSpotOverlap</li>
          <li>PlaceWorker_ShowTurretRadius</li>
        </value>
      </li>
      <li Class="PatchOperationAdd">
        <success>Always</success>
        <xpath>/Defs/ThingDef[defName="VulcanCannon"]/building/placeWorkers</xpath>
        <value>
          <li>PlaceWorker_TurretTop</li>
          <li>PlaceWorker_ShowTurretRadius</li>
        </value>
      </li>
    </operations>
  </Operation>
  <Operation Class="PatchOperationSequence">
    <success>Always</success>
    <operations>
      <li Class="PatchOperationTest">
        <xpath>/Defs/ThingDef[defName="GunComplex"]/uiIconPath</xpath>
        <success>Invert</success>
      </li>
      <li Class="PatchOperationAdd">
        <success>Always</success>
        <xpath>/Defs/ThingDef[defName="GunComplex"]</xpath>
        <value>
          <uiIconPath>Security/GunComplex_UI</uiIconPath>
        </value>
      </li>
      <li Class="PatchOperationAdd">
        <success>Always</success>
        <xpath>/Defs/ThingDef[defName="GunComplex"]/building/placeWorkers</xpath>
        <value>
          <li>PlaceWorker_TurretTop</li>
          <li>PlaceWorker_PreventInteractionSpotOverlap</li>
          <li>PlaceWorker_ShowTurretRadius</li>
        </value>
      </li>
    </operations>
  </Operation>
  <Operation Class="PatchOperationSequence">
    <success>Always</success>
    <operations>
      <li Class="PatchOperationTest">
        <xpath>/Defs/ThingDef[defName="RocketComplex"]/uiIconPath</xpath>
        <success>Invert</success>
      </li>
      <li Class="PatchOperationAdd">
        <success>Always</success>
        <xpath>/Defs/ThingDef[defName="RocketComplex"]</xpath>
        <value>
          <uiIconPath>Security/RocketComplex_UI</uiIconPath>
        </value>
      </li>
      <li Class="PatchOperationAdd">
        <success>Always</success>
        <xpath>/Defs/ThingDef[defName="RocketComplex"]/building/placeWorkers</xpath>
        <value>
          <li>PlaceWorker_TurretTop</li>
          <li>PlaceWorker_PreventInteractionSpotOverlap</li>
          <li>PlaceWorker_ShowTurretRadius</li>
        </value>
      </li>
    </operations>
  </Operation>
  <Operation Class="PatchOperationSequence">
    <success>Always</success>
    <operations>
      <li Class="PatchOperationTest">
        <xpath>/Defs/ThingDef[defName="Turret_DevastatorMortarBomb"]/uiIconPath</xpath>
        <success>Invert</success>
      </li>
      <li Class="PatchOperationAdd">
        <success>Always</success>
        <xpath>/Defs/ThingDef[defName="Turret_DevastatorMortarBomb"]</xpath>
        <value>
          <uiIconPath>Security/DevastatorMortar_UI</uiIconPath>
        </value>
      </li>
      <li Class="PatchOperationAdd">
        <success>Always</success>
        <xpath>/Defs/ThingDef[defName="Turret_DevastatorMortarBomb"]</xpath>
        <value>
          <inspectorTabs>
            <li>ITab_Shells</li>
          </inspectorTabs>
        </value>
      </li>
      <li Class="PatchOperationAdd">
        <success>Always</success>
        <xpath>/Defs/ThingDef[defName="Turret_DevastatorMortarBomb"]/building/buildingTags</xpath>
        <value>
          <li>Artillery_BaseDestroyer</li>
          <li>Artillery_MannedMortar</li>
        </value>
      </li>
      <li Class="PatchOperationAdd">
        <success>Always</success>
        <xpath>/Defs/ThingDef[defName="Turret_DevastatorMortarBomb"]/building/placeWorkers</xpath>
        <value>
          <li>PlaceWorker_TurretTop</li>
          <li>PlaceWorker_PreventInteractionSpotOverlap</li>
        </value>
      </li>
      <li Class="PatchOperationReplace">
        <success>Always</success>
        <xpath>/Defs/ThingDef[defName="Turret_DevastatorMortarBomb"]/terrainAffordanceNeeded</xpath>
        <value>
          <terrainAffordanceNeeded>Heavy</terrainAffordanceNeeded>
        </value>
      </li>
      <li Class="PatchOperationAdd">
        <success>Always</success>
        <xpath>/Defs</xpath>
        <value>
          <RecipeDef>
            <defName>MakeParticleCell</defName>
            <label>make devastator particle cell</label>
            <description>Craft a devastator particle cell.</description>
            <jobString>Making devastator particle cell.</jobString>
            <workSpeedStat>GeneralLaborSpeed</workSpeedStat>
            <effectWorking>Cook</effectWorking>
            <soundWorking>Recipe_Machining</soundWorking>
            <allowMixingIngredients>true</allowMixingIngredients>
            <workAmount>2400</workAmount>
            <unfinishedThingDef>UnfinishedCell</unfinishedThingDef>
            <targetCountAdjustment>5</targetCountAdjustment>
            <ingredients>
              <li>
                <filter>
                  <thingDefs>
                    <li>ComponentIndustrial</li>
                  </thingDefs>
                </filter>
                <count>1</count>
              </li>
            </ingredients>
            <fixedIngredientFilter>
              <thingDefs>
                <li>ComponentIndustrial</li>
              </thingDefs>
            </fixedIngredientFilter>
            <products>
              <ParticleCell>1</ParticleCell>
            </products>
            <skillRequirements>
              <Crafting>10</Crafting>
            </skillRequirements>
            <workSkill>Crafting</workSkill>
          </RecipeDef>
        </value>
      </li>
      <li Class="PatchOperationAdd">
        <success>Always</success>
        <xpath>/Defs</xpath>
        <value>
          <ThingDef ParentName="UnfinishedBase">
            <defName>UnfinishedCell</defName>
            <label>unfinished cell</label>
            <graphicData>
              <texPath>Things/Building/Security/DevCellNA</texPath>
              <graphicClass>Graphic_Single</graphicClass>
            </graphicData>
            <stuffCategories />
          </ThingDef>
        </value>
      </li>
      <li Class="PatchOperationAdd">
        <success>Always</success>
        <xpath>/Defs</xpath>
        <value>
          <ThingDef ParentName="ResourceBase">
            <defName>ParticleCell</defName>
            <label>devastator power cell</label>
            <description>A power cell designed for devastator mortars. Explodes with EMP discharge when damaged.</description>
            <graphicData>
              <texPath>Things/Building/Security/DevCellC</texPath>
              <graphicClass>Graphic_Single</graphicClass>
            </graphicData>
            <statBases>
              <MaxHitPoints>70</MaxHitPoints>
              <MarketValue>77</MarketValue>
              <Mass>10</Mass>
              <Flammability>1.0</Flammability>
              <DeteriorationRate>2</DeteriorationRate>
            </statBases>
            <comps>
              <li Class="CompProperties_Explosive">
                <explosiveRadius>6</explosiveRadius>
                <explosiveDamageType>EMP</explosiveDamageType>
                <explosiveExpandPerStackcount>0.4</explosiveExpandPerStackcount>
                <startWickHitPointsPercent>0.333</startWickHitPointsPercent>
                <wickTicks>10~30</wickTicks>
              </li>
            </comps>
            <projectileWhenLoaded>Bullet_DevastatorBomb</projectileWhenLoaded>
            <soundInteract>Metal_Drop</soundInteract>
            <soundDrop>Standard_Drop</soundDrop>
            <tickerType>Normal</tickerType>
            <stackLimit>25</stackLimit>
            <thingCategories>
              <li>Manufactured</li>
            </thingCategories>
            <tradeTags>
              <li>MortarShell</li>
            </tradeTags>
          </ThingDef>
        </value>
      </li>
      <li Class="PatchOperationAdd">
        <success>Always</success>
        <xpath>/Defs</xpath>
        <value>
          <ThingDef ParentName="BenchBase">
            <defName>CellFabricator</defName>
            <label>cell fabricator</label>
            <thingClass>Building_WorkTable</thingClass>
            <description>A very power hungry station designed for assembling devastator power cells.</description>
            <graphicData>
              <texPath>Things/Building/Security/CellFabricator</texPath>
              <graphicClass>Graphic_Multi</graphicClass>
              <drawSize>(1.5)</drawSize>
              <damageData>
                <cornerTL>Damage/Corner</cornerTL>
                <cornerTR>Damage/Corner</cornerTR>
                <cornerBL>Damage/Corner</cornerBL>
                <cornerBR>Damage/Corner</cornerBR>
              </damageData>
            </graphicData>
            <costList>
              <Plasteel>100</Plasteel>
              <ComponentIndustrial>10</ComponentIndustrial>
              <Gold>100</Gold>
            </costList>
            <altitudeLayer>Building</altitudeLayer>
            <fillPercent>0.5</fillPercent>
            <useHitPoints>True</useHitPoints>
            <statBases>
              <WorkToBuild>3000</WorkToBuild>
              <MaxHitPoints>180</MaxHitPoints>
              <Flammability>1.0</Flammability>
              <Cleanliness>-2</Cleanliness>
            </statBases>
            <size>(1,1)</size>
            <designationCategory>Production</designationCategory>
            <passability>PassThroughOnly</passability>
            <pathCost>70</pathCost>
            <hasInteractionCell>True</hasInteractionCell>
            <interactionCellOffset>(0,0,-1)</interactionCellOffset>
            <surfaceType>Item</surfaceType>
            <recipes>
              <li>MakeParticleCell</li>
            </recipes>
            <inspectorTabs>
              <li>ITab_Bills</li>
            </inspectorTabs>
            <comps>
              <li Class="CompProperties_Power">
                <compClass>CompPowerTrader</compClass>
                <basePowerConsumption>5000</basePowerConsumption>
              </li>
              <li Class="CompProperties_Flickable" />
              <li Class="CompProperties_Glower">
                <glowRadius>5</glowRadius>
                <glowColor>(73,140,150,0)</glowColor>
              </li>
              <li Class="CompProperties_AffectedByFacilities">
                <linkableFacilities>
                  <li>ToolCabinet</li>
                </linkableFacilities>
              </li>
              <li Class="CompProperties_Breakdownable" />
            </comps>
            <building>
              <spawnedConceptLearnOpportunity>BillsTab</spawnedConceptLearnOpportunity>
            </building>
            <constructEffect>ConstructMetal</constructEffect>
            <researchPrerequisites>
              <li>DevastatorMortar</li>
            </researchPrerequisites>
            <placeWorkers>
              <li>PlaceWorker_ShowFacilitiesConnections</li>
            </placeWorkers>
          </ThingDef>
        </value>
      </li>
    </operations>
  </Operation>
  <Operation Class="PatchOperationSequence">
    <success>Always</success>
    <operations>
      <li Class="PatchOperationTest">
        <xpath>/Defs/ThingDef[defName="Artillery_DevastatorBomb"]/building</xpath>
        <success>Invert</success>
      </li>
      <li Class="PatchOperationAdd">
        <success>Always</success>
        <xpath>/Defs/ThingDef[defName="Artillery_DevastatorBomb"]</xpath>
        <value>
          <comps>
            <li Class="CompProperties_ChangeableProjectile" />
          </comps>
        </value>
      </li>
      <li Class="PatchOperationAdd">
        <success>Always</success>
        <xpath>/Defs/ThingDef[defName="Artillery_DevastatorBomb"]</xpath>
        <value>
          <building>
            <fixedStorageSettings>
              <filter>
                <thingDefs>
                  <li>ParticleCell</li>
                </thingDefs>
              </filter>
            </fixedStorageSettings>
          </building>
        </value>
      </li>
      <li Class="PatchOperationReplace">
        <success>Always</success>
        <xpath>/Defs/ThingDef[defName="Artillery_DevastatorBomb"]/verbs</xpath>
        <value>
          <verbs>
            <li>
              <verbClass>Verb_Shoot</verbClass>
              <forceNormalTimeSpeed>false</forceNormalTimeSpeed>
              <warmupTime>8.3</warmupTime>
              <forcedMissRadius>7</forcedMissRadius>
              <requireLineOfSight>false</requireLineOfSight>
              <minRange>20</minRange>
              <range>500</range>
              <burstShotCount>1</burstShotCount>
              <soundCast>ChargeLance_Fire</soundCast>
              <soundCastTail>GunTail_Heavy</soundCastTail>
              <muzzleFlashScale>55</muzzleFlashScale>
              <targetParams>
                <canTargetLocations>true</canTargetLocations>
              </targetParams>
            </li>
          </verbs>
        </value>
      </li>
    </operations>
  </Operation>
</Patch>